<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>Заголовок</title>
<!-- Search Engine -->
<meta name="description" content="Частичные сортировки Требуется узнать первые  k  элементов в отсортированном массиве. Варианты:1. Отсортировать весь массив полностью  O(n\log n) 
">
<meta name="image" content="https://demiurg906.github.io/au-algorithms-sem_1/preview.png">
<!-- Schema.org for Google -->
<meta itemprop="name" content="Заголовок">
<meta itemprop="description" content="Частичные сортировки Требуется узнать первые  k  элементов в отсортированном массиве. Варианты:1. Отсортировать весь массив полностью  O(n\log n) 
">
<meta itemprop="image" content="https://demiurg906.github.io/au-algorithms-sem_1/preview.png">
<!-- Twitter -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Заголовок">
<meta name="twitter:description" content="Частичные сортировки Требуется узнать первые  k  элементов в отсортированном массиве. Варианты:1. Отсортировать весь массив полностью  O(n\log n) 
">
<meta name="twitter:image:src" content="https://demiurg906.github.io/au-algorithms-sem_1/preview.png">
<!-- Twitter - Article -->
<!-- Open Graph general (Facebook, Pinterest & Google+) -->
<meta property="og:title" content="Заголовок">
<meta property="og:description" content="Частичные сортировки Требуется узнать первые  k  элементов в отсортированном массиве. Варианты:1. Отсортировать весь массив полностью  O(n\log n) 
">
<meta property="og:image" content="https://demiurg906.github.io/au-algorithms-sem_1/preview.png">
<meta property="og:type" content="article">
<!-- Open Graph - Article -->

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="https://demiurg906.github.io/au-algorithms-sem_1/assets/style.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js" integrity="sha256-MRn7pN9LOBMrkp+8F2t5xb/92V1irzXp/dl5tUTwEgE=" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github-gist.min.css" integrity="sha256-tAflq+ymku3Khs+I/WcAneIlafYgDiOQ9stIHH985Wo=" crossorigin="anonymous" />
<script src="https://demiurg906.github.io/au-algorithms-sem_1/assets/xpath.js" type="text/javascript"></script>
<script>newIssue="https://github.com/demiurg906/au-algorithms-sem_1/issues/new"</script>
<script src="https://demiurg906.github.io/au-algorithms-sem_1/assets/load.js"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax:    {
    inlineMath:  [['$','$'],  ['\\(','\\)']],
    displayMath: [["$$","$$"],["\\[","\\]"]],
    displayAlign: "center"
    // processEscapes: true
  },
  CommonHTML: { linebreaks: { automatic: true } },
  "HTML-CSS": { linebreaks: { automatic: true } },
         SVG: { linebreaks: { automatic: true } }
});
</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<body>
  <div id="mistake">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 402.938 402.938"><path d="M401.785 33.437C399.28 18.683 389.61 16.48 384.07 16.48c-22.935 0-65.053 36.684-109.644 75.52-18.23 15.88-37.083 32.3-53.502 45.048-5.858 4.548-11.803 9.103-18.097 13.924-31.276 23.96-66.726 51.12-94.16 80.356-26.887 28.65-42.593 55.62-47.676 81.98L4.12 364.683c-5.122 4.628-5.523 12.532-.896 17.655 2.468 2.732 5.867 4.12 9.28 4.12 2.987 0 5.984-1.063 8.375-3.223l47.816-43.194c2.31.634 5.016.963 8.19.963 27.39 0 93.534-24.866 153.857-57.84l6.043-3.305L226.11 269.8l17.888 5.932 1.947-1.13c15.867-9.21 30.165-18.41 42.496-27.338 2.19-1.586 4.45-3.292 7.115-5.372l3.87-3.02-11.223-14.93 20.26 7.21 2.218-2.02c15.51-14.13 29.805-30.467 42.486-48.554l2.428-3.462-18.606-18.342 25.257 8.17 2.054-3.37c28.307-46.454 43.02-97.535 37.485-130.137z"/></svg>
  </div>

  <article class="content">
      

      
      <div class="navigation">
        <a href="lec_1_05.html">← взад</a>
        <a href="index.html">к оглавлению</a>
        <a href="lec_1_07.html">вперёд →</a>
      </div>
      
      <h2 id="Частичные-сортировки"><a aria-hidden="true" href="#Частичные-сортировки"><span class="icon icon-link"></span></a>Частичные сортировки</h2>
<p>Требуется узнать первые <span class="inlineMath">$k$</span> элементов в отсортированном массиве.</p>
<p>Варианты:
1. Отсортировать весь массив полностью <span class="inlineMath">$O(n\log n)$</span>
2. Неполная HeapSort:
<span class="inlineMath">$T(k, n) = T(makeheap) + k \cdot T(extract_min) = O(n) + k\cdot O(\log n)$</span>.
Если <span class="inlineMath">$k=o\left(\frac{n}{\log n}\right) \Rightarrow T(k, n) = O(n)$</span>.
Быстрее (ассимптотически) сделать нельзя.
3. Запустить QuickSort только на тех левых половинах, длина которых меньше <span class="inlineMath">$k$</span>.
Время работы <span class="inlineMath">$O(n + k\log k)$</span> в среднем (доказательство ниже).</p>
<h2 id="Порядковые-статистики"><a aria-hidden="true" href="#Порядковые-статистики"><span class="icon icon-link"></span></a>Порядковые статистики</h2>
<p><span class="inlineMath">$k$</span>-я <a class="term">порядковая статистика</a> для массива -- это элемент, который будет стоять на <span class="inlineMath">$k$</span>-ом месте в отсортированном массиве.
Медиана -- это <span class="inlineMath">$\left\lceil\frac n2\right\rceil$</span> порядковая статистика</p>
<h3 id="randomized-selection"><a aria-hidden="true" href="#randomized-selection"><span class="icon icon-link"></span></a>Randomized selection</h3>
<pre><code class="language-python">def randomized_selection(a, r, l, k):
    px = rand(l, r)
    m_l, m_r = partition3(a, l, r, px)  # берем partition, который учитывает одинаковые элементы
    if m_l - l > k:
        return randomized_selection(a, l, m_l, k)
    elif m_r - l > k:
        return a[m_l]
    else:
        return randomized_selection(a, m_r, r, k - m_r)
</code></pre>
<p><strong>Оценка:</strong>
1. Худший случай:
<span class="inlineMath">$T(n) \leq T(n-1) + O(n) = O(n^2)$</span>
2. Средний случай:
<span class="inlineMath">$E(\#\text{partition: получим "хорошее разбиение"}) = 2$</span>
<span class="inlineMath">$E(T(n)) \leq E(T(3/4 n)) + E(\#...) \cdot O(n) = E(T(3/4 n)) + O(n) = O(n)$</span></p>
<p><strong>Сравнение с частичной сортировкой:</strong>
<span class="inlineMath">$T(\text{PartialQuickSort(n, k)}) \leq T(\text{RandomizedSelection(n, k)}) + T(\text{QuickSort(k)}) = O(n) + O(k\log k)$</span></p>
<h3 id="Медиана-медиан-Блюм-Флойд-Пратт-Равест-Таржан"><a aria-hidden="true" href="#Медиана-медиан-Блюм-Флойд-Пратт-Равест-Таржан"><span class="icon icon-link"></span></a>"Медиана медиан" (Блюм-Флойд-Пратт-Равест-Таржан)</h3>
<ol>
<li>Разбиваем массив на группы по пять элементов</li>
<li>Сортируем группы</li>
<li>Строим массив <code>b</code>, состоящий из медиан этих групп</li>
<li>Вызываемся рекурсивно на <code>b</code> и получаем медиану <code>m</code></li>
<li>Используем <code>m</code> в <code>partition</code> и вызываемся рекурсивно</li>
</ol>
<pre><code class="language-python">def mm(a, l, r, k):
    if l - r == 1:
        return a[l]
    sort_by_5(a, l, r)
    b = medians_by_5(a, l, r)
    m = mm(b, 0, len(b), len(b) / 2)
    px = a[m]
    i = partition(a, l, r, px)
    if i == k:
        return a[i]
    if i > k:
        return mm(a, l, i, k)
    else:
        return mm(a, i, r, k - d)
</code></pre>
<p><strong>Оценка:</strong></p>
<!-- *Тут была красивая картинка с разбиением массива на пятерки* -->
<p><span class="inlineMath">$T(n) \leq T\left(\frac n5\right) + T\left(n\cdot \frac 7{10}\right) + O(n)$</span>
Хотим доказать <span class="inlineMath">$T(n) = O(n) \leq C\cdot n + d$</span>
<span class="inlineMath">$C\cdot n + d \leq C\cdot \frac n5 + d + C\cdot \frac {7n}{10} + d + \alpha n + \beta$</span></p>
<ul>
<li><span class="inlineMath">$d = \beta$</span></li>
<li><span class="inlineMath">$C\cdot \left( 1 - \frac 15 - \frac 7{10}\right) = 0.1 C = \alpha \Rightarrow C = 10\alpha$</span></li>
</ul>
<p><strong>Следствие:</strong>
QuickSort можно реализовать за <span class="inlineMath">$O(n\log n)$</span> в худшем случае.</p>
<script>
var terms = {"\u043f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430": {"wiki": {"type": "standard", "title": "\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430", "namespace": {"id": 0, "text": ""}, "titles": {"canonical": "\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f_\u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430", "normalized": "\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430", "display": "\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430"}, "revision": "75285615", "tid": "b715cbe0-6e6c-11e8-ba37-caa1b5371af0", "content_urls": {"desktop": {"page": "https://ru.wikipedia.org/wiki/\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f_\u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430", "revisions": "https://ru.wikipedia.org/wiki/\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f_\u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430?action=history", "edit": "https://ru.wikipedia.org/wiki/\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f_\u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430?action=edit", "talk": "https://ru.wikipedia.org/wiki/\u041e\u0431\u0441\u0443\u0436\u0434\u0435\u043d\u0438\u0435:\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f_\u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430"}, "mobile": {"page": "https://ru.m.wikipedia.org/wiki/\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f_\u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430", "revisions": "https://ru.m.wikipedia.org/wiki/Special:History/\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f_\u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430", "edit": "https://ru.m.wikipedia.org/wiki/\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f_\u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430?action=edit", "talk": "https://ru.m.wikipedia.org/wiki/\u041e\u0431\u0441\u0443\u0436\u0434\u0435\u043d\u0438\u0435:\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f_\u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430"}}, "api_urls": {"summary": "https://ru.wikipedia.org/api/rest_v1/page/summary/\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f_\u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430", "metadata": "https://ru.wikipedia.org/api/rest_v1/page/metadata/\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f_\u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430", "references": "https://ru.wikipedia.org/api/rest_v1/page/references/\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f_\u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430", "media": "https://ru.wikipedia.org/api/rest_v1/page/media/\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f_\u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430", "edit_html": "https://ru.wikipedia.org/api/rest_v1/page/html/\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f_\u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430", "talk_page_html": "https://ru.wikipedia.org/api/rest_v1/page/html/\u041e\u0431\u0441\u0443\u0436\u0434\u0435\u043d\u0438\u0435:\u041f\u043e\u0440\u044f\u0434\u043a\u043e\u0432\u0430\u044f_\u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430"}, "extract": "\u041f\u043e\u0440\u044f\u0301\u0434\u043a\u043e\u0432\u044b\u0435 \u0441\u0442\u0430\u0442\u0438\u0301\u0441\u0442\u0438\u043a\u0438 \u0432 \u043c\u0430\u0442\u0435\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0435 - \u044d\u0442\u043e \u0443\u043f\u043e\u0440\u044f\u0434\u043e\u0447\u0435\u043d\u043d\u0430\u044f \u043f\u043e \u043d\u0435\u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e \u0432\u044b\u0431\u043e\u0440\u043a\u0430 \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u043e \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u044b\u0445 \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u044b\u0445 \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u044b\u0445 \u0432\u0435\u043b\u0438\u0447\u0438\u043d \u0438 \u0435\u0451 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u044b, \u0437\u0430\u043d\u0438\u043c\u0430\u044e\u0449\u0438\u0435 \u0441\u0442\u0440\u043e\u0433\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0435 \u043c\u0435\u0441\u0442\u043e \u0432 \u0440\u0430\u043d\u0436\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u0441\u043e\u0432\u043e\u043a\u0443\u043f\u043d\u043e\u0441\u0442\u0438.", "extract_html": "<p><b>\u041f\u043e\u0440\u044f\u0301\u0434\u043a\u043e\u0432\u044b\u0435 \u0441\u0442\u0430\u0442\u0438\u0301\u0441\u0442\u0438\u043a\u0438</b> \u0432 \u043c\u0430\u0442\u0435\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0435 - \u044d\u0442\u043e \u0443\u043f\u043e\u0440\u044f\u0434\u043e\u0447\u0435\u043d\u043d\u0430\u044f \u043f\u043e \u043d\u0435\u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e \u0432\u044b\u0431\u043e\u0440\u043a\u0430 \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u043e \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0451\u043d\u043d\u044b\u0445 \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u044b\u0445 \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u044b\u0445 \u0432\u0435\u043b\u0438\u0447\u0438\u043d \u0438 \u0435\u0451 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u044b, \u0437\u0430\u043d\u0438\u043c\u0430\u044e\u0449\u0438\u0435 \u0441\u0442\u0440\u043e\u0433\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0435 \u043c\u0435\u0441\u0442\u043e \u0432 \u0440\u0430\u043d\u0436\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0439 \u0441\u043e\u0432\u043e\u043a\u0443\u043f\u043d\u043e\u0441\u0442\u0438.</p>", "wiki_url": "https://ru.wikipedia.org/wiki/%D0%9F%D0%BE%D1%80%D1%8F%D0%B4%D0%BA%D0%BE%D0%B2%D0%B0%D1%8F_%D1%81%D1%82%D0%B0%D1%82%D0%B8%D1%81%D1%82%D0%B8%D0%BA%D0%B0"}}};
</script>

      
      <div class="navigation">
          <a href="lec_1_05.html">← взад</a>
          <a href="index.html">на главную</a>
          <a href="lec_1_07.html">вперёд →</a>
      </div>
      

      
  </article>
<script src="https://demiurg906.github.io/au-algorithms-sem_1/assets/popup.js"></script>
</body>
</html>