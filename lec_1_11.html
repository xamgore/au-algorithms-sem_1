<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8">
<title>Заголовок</title>
<!-- Search Engine -->
<meta name="description" content="Кратчайшие пути в графах с отрицательными весами Утверждение:  в случае, если есть ребра отрицательного веса, то кратчайшие пути могут быть не определены (">
<meta name="image" content="https://demiurg906.github.io/au-algorithms-sem_1/preview.png">
<!-- Schema.org for Google -->
<meta itemprop="name" content="Заголовок">
<meta itemprop="description" content="Кратчайшие пути в графах с отрицательными весами Утверждение:  в случае, если есть ребра отрицательного веса, то кратчайшие пути могут быть не определены (">
<meta itemprop="image" content="https://demiurg906.github.io/au-algorithms-sem_1/preview.png">
<!-- Twitter -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Заголовок">
<meta name="twitter:description" content="Кратчайшие пути в графах с отрицательными весами Утверждение:  в случае, если есть ребра отрицательного веса, то кратчайшие пути могут быть не определены (">
<meta name="twitter:image:src" content="https://demiurg906.github.io/au-algorithms-sem_1/preview.png">
<!-- Twitter - Article -->
<!-- Open Graph general (Facebook, Pinterest & Google+) -->
<meta property="og:title" content="Заголовок">
<meta property="og:description" content="Кратчайшие пути в графах с отрицательными весами Утверждение:  в случае, если есть ребра отрицательного веса, то кратчайшие пути могут быть не определены (">
<meta property="og:image" content="https://demiurg906.github.io/au-algorithms-sem_1/preview.png">
<meta property="og:type" content="article">
<!-- Open Graph - Article -->

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="https://demiurg906.github.io/au-algorithms-sem_1/assets/style.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/python.min.js" integrity="sha256-MRn7pN9LOBMrkp+8F2t5xb/92V1irzXp/dl5tUTwEgE=" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github-gist.min.css" integrity="sha256-tAflq+ymku3Khs+I/WcAneIlafYgDiOQ9stIHH985Wo=" crossorigin="anonymous" />
<script src="https://demiurg906.github.io/au-algorithms-sem_1/assets/xpath.js" type="text/javascript"></script>
<script>newIssue="https://github.com/demiurg906/au-algorithms-sem_1/issues/new"</script>
<script src="https://demiurg906.github.io/au-algorithms-sem_1/assets/load.js"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax:    {
    inlineMath:  [['$','$'],  ['\\(','\\)']],
    displayMath: [["$$","$$"],["\\[","\\]"]],
    displayAlign: "center"
    // processEscapes: true
  },
  CommonHTML: { linebreaks: { automatic: true } },
  "HTML-CSS": { linebreaks: { automatic: true } },
         SVG: { linebreaks: { automatic: true } }
});
</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML">
</script>
</head>
<body>
  <div id="mistake">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 402.938 402.938"><path d="M401.785 33.437C399.28 18.683 389.61 16.48 384.07 16.48c-22.935 0-65.053 36.684-109.644 75.52-18.23 15.88-37.083 32.3-53.502 45.048-5.858 4.548-11.803 9.103-18.097 13.924-31.276 23.96-66.726 51.12-94.16 80.356-26.887 28.65-42.593 55.62-47.676 81.98L4.12 364.683c-5.122 4.628-5.523 12.532-.896 17.655 2.468 2.732 5.867 4.12 9.28 4.12 2.987 0 5.984-1.063 8.375-3.223l47.816-43.194c2.31.634 5.016.963 8.19.963 27.39 0 93.534-24.866 153.857-57.84l6.043-3.305L226.11 269.8l17.888 5.932 1.947-1.13c15.867-9.21 30.165-18.41 42.496-27.338 2.19-1.586 4.45-3.292 7.115-5.372l3.87-3.02-11.223-14.93 20.26 7.21 2.218-2.02c15.51-14.13 29.805-30.467 42.486-48.554l2.428-3.462-18.606-18.342 25.257 8.17 2.054-3.37c28.307-46.454 43.02-97.535 37.485-130.137z"/></svg>
  </div>

  <article class="content">
      

      
      <div class="navigation">
        <a href="lec_1_10.html">← взад</a>
        <a href="index.html">к оглавлению</a>
        <a href="lec_1_12.html">вперёд →</a>
      </div>
      
      <h2 id="Кратчайшие-пути-в-графах-с-отрицательными-весами"><a aria-hidden="true" href="#Кратчайшие-пути-в-графах-с-отрицательными-весами"><span class="icon icon-link"></span></a>Кратчайшие пути в графах с отрицательными весами</h2>
<p><strong>Утверждение:</strong> в случае, если есть ребра отрицательного веса, то кратчайшие пути могут быть не определены (если есть отрицательный цикл, то по нему можно бесконечно долго наматывать).</p>
<h3 id="Алгоритм-Беллмана-Форда"><a aria-hidden="true" href="#Алгоритм-Беллмана-Форда"><span class="icon icon-link"></span></a>Алгоритм Беллмана-Форда</h3>
<p><a class="term">Алгоритм Беллмана-Форда</a> -- хороший алгоритм (вы ведь понимаете, что такие фразочки я вставляю только ради ссылок на вики, да?).</p>
<p><strong>Релакация ребра:</strong> <span class="inlineMath">$e = (u\rightarrow v)$</span>. <span class="inlineMath">$dist[v] = \min(dist[v], dist[u] + \omega(e))$</span>.</p>
<p><strong>Утверждения:</strong>
1. <span class="inlineMath">$dist[v]\geq dist(s, v)$</span>
2. Пусть <span class="inlineMath">$s\rightarrow v_1\rightarrow ...\rightarrow v_k\rightarrow v$</span> -- оптимальный путь от <span class="inlineMath">$s$</span> до <span class="inlineMath">$v$</span>. Если <span class="inlineMath">$dist[v_k]$</span> -- оптимальный, то после релаксации <span class="inlineMath">$(v_k\rightarrow v)\ \ dist[v]$</span> тоже становится оптимальным.
3. Пусть <span class="inlineMath">$e_1...e_k$</span> -- это ребра кратчайшего пути от <span class="inlineMath">$s$</span> до <span class="inlineMath">$v$</span>. Если последовательно прорелаксировать ребра <span class="inlineMath">$e_1..e_k$</span>, то мы вычислим оптимальный путь до <span class="inlineMath">$v$</span>.</p>
<p><strong>Идея алгоритма:</strong> давайте <span class="inlineMath">$V-1$</span> раз прорелаксируем все ребра.</p>
<p><strong>Утверждение:</strong> если на какой-то итерации ничего не изменилось -- найдены все минимальные пути.</p>
<pre><code class="language-python">def bellman_ford(g, s):
    V = len(g.v)
    dist = [inf for _ in range(V)]
    prev = [0 for _ in range(V)]

    dist[s] = 0
    for i in range(V - 1):
        for (u, v) in g.e:  # итерируемся по ребрам
            if dist[v] > dist[u] + w(u, v):
                dist[v] = dist[u] + w(u, v)
                prev[v] = u
    # тут опущена оптимизация из последнего утверждения
    return dist
</code></pre>
<p><strong>Время работы:</strong> <span class="inlineMath">$O(V\cdot E)$</span>. Если граф плотный, то <span class="inlineMath">$E\sim V^2$</span>, и время работы <span class="inlineMath">$O(V^3)$</span>.</p>
<p><strong>Утверждение:</strong> работает в случае отрицательных ребер (в предыдущих утверждениях мы никак не использовали положительность ребер)</p>
<h4 id="Поиск-отрицательного-цикла"><a aria-hidden="true" href="#Поиск-отрицательного-цикла"><span class="icon icon-link"></span></a>Поиск отрицательного цикла</h4>
<p><strong>Утверждение:</strong> если в алгоритме Форда-Беллмана сделать на одну итерацию больше, то тогда и только огда отрицательный цикл существует, если на этой последней итерации массив <span class="inlineMath">$dist$</span> как-то изменился. Доказательство очевидно.</p>
<h3 id="Алгоритм-Флойда-Уоршала"><a aria-hidden="true" href="#Алгоритм-Флойда-Уоршала"><span class="icon icon-link"></span></a>Алгоритм Флойда-Уоршала</h3>
<p>Про данный алгоритм можно почитать на <a href="https://ru.wikipedia.org/wiki/%D0%90%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC_%D0%A4%D0%BB%D0%BE%D0%B9%D0%B4%D0%B0_%E2%80%94_%D0%A3%D0%BE%D1%80%D1%88%D0%B5%D0%BB%D0%BB%D0%B0">вики</a> или на <a href="http://neerc.ifmo.ru/wiki/index.php?title=%D0%90%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC_%D0%A4%D0%BB%D0%BE%D0%B9%D0%B4%D0%B0">neerc.ifmo</a>.</p>
<p><strong>Основная идея:</strong> ищем кратчайшие пути между всеми парами вершин. <span class="inlineMath">$V$</span> раз релаксируем всевозможные пары вершин, получаем ответ.</p>
<p><strong>Время работы:</strong> <span class="inlineMath">$O(V^3)$</span></p>
<h3 id="Алгоритм-Джонсона"><a aria-hidden="true" href="#Алгоритм-Джонсона"><span class="icon icon-link"></span></a>Алгоритм Джонсона</h3>
<p>Про данный алгоритм можно почитать на <a href="https://ru.wikipedia.org/wiki/%D0%90%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC_%D0%94%D0%B6%D0%BE%D0%BD%D1%81%D0%BE%D0%BD%D0%B0">вики</a> или на <a href="http://neerc.ifmo.ru/wiki/index.php?title=%D0%90%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC_%D0%94%D0%B6%D0%BE%D0%BD%D1%81%D0%BE%D0%BD%D0%B0">neerc.ifmo</a>.</p>
<p><strong>Основная идея:</strong> хитрый алгоритм, ищет все попарный расстояния. Сначала с помощью Беллмана-Форда (от произвольной вершины) находятся некие <span class="inlineMath">$h$</span> для каждого ребра, через которые вычисляются дельты для каждого ребра, которые делают все ребра положительными, но при этом сохраняют кратчайшие пути. Полсе этого для каждой верины запускается обычный Дейкстра.</p>
<p><strong>Время работы:</strong> зависит от реализации очереди внутри Дейкстры. Возможны варианты <span class="inlineMath">$O(V^2\log V + VE)$</span> (на фиббоначиевой куче) и <span class="inlineMath">$O(VE\log V)$</span> (на обычной куче). Для разреженных графов работыет быстрее, чем Флойд-Уоршал.</p>
<script>
var terms = {"\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430-\u0424\u043e\u0440\u0434\u0430": {"wiki": {"type": "standard", "title": "\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430 \u2014 \u0424\u043e\u0440\u0434\u0430", "namespace": {"id": 0, "text": ""}, "titles": {"canonical": "\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c_\u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430_\u2014_\u0424\u043e\u0440\u0434\u0430", "normalized": "\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430 \u2014 \u0424\u043e\u0440\u0434\u0430", "display": "\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430 \u2014 \u0424\u043e\u0440\u0434\u0430"}, "revision": "92055265", "tid": "32193699-68cf-11e8-b2ae-9f89df53482a", "content_urls": {"desktop": {"page": "https://ru.wikipedia.org/wiki/\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c_\u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430_\u2014_\u0424\u043e\u0440\u0434\u0430", "revisions": "https://ru.wikipedia.org/wiki/\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c_\u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430_\u2014_\u0424\u043e\u0440\u0434\u0430?action=history", "edit": "https://ru.wikipedia.org/wiki/\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c_\u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430_\u2014_\u0424\u043e\u0440\u0434\u0430?action=edit", "talk": "https://ru.wikipedia.org/wiki/\u041e\u0431\u0441\u0443\u0436\u0434\u0435\u043d\u0438\u0435:\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c_\u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430_\u2014_\u0424\u043e\u0440\u0434\u0430"}, "mobile": {"page": "https://ru.m.wikipedia.org/wiki/\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c_\u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430_\u2014_\u0424\u043e\u0440\u0434\u0430", "revisions": "https://ru.m.wikipedia.org/wiki/Special:History/\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c_\u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430_\u2014_\u0424\u043e\u0440\u0434\u0430", "edit": "https://ru.m.wikipedia.org/wiki/\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c_\u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430_\u2014_\u0424\u043e\u0440\u0434\u0430?action=edit", "talk": "https://ru.m.wikipedia.org/wiki/\u041e\u0431\u0441\u0443\u0436\u0434\u0435\u043d\u0438\u0435:\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c_\u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430_\u2014_\u0424\u043e\u0440\u0434\u0430"}}, "api_urls": {"summary": "https://ru.wikipedia.org/api/rest_v1/page/summary/\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c_\u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430_\u2014_\u0424\u043e\u0440\u0434\u0430", "metadata": "https://ru.wikipedia.org/api/rest_v1/page/metadata/\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c_\u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430_\u2014_\u0424\u043e\u0440\u0434\u0430", "references": "https://ru.wikipedia.org/api/rest_v1/page/references/\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c_\u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430_\u2014_\u0424\u043e\u0440\u0434\u0430", "media": "https://ru.wikipedia.org/api/rest_v1/page/media/\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c_\u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430_\u2014_\u0424\u043e\u0440\u0434\u0430", "edit_html": "https://ru.wikipedia.org/api/rest_v1/page/html/\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c_\u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430_\u2014_\u0424\u043e\u0440\u0434\u0430", "talk_page_html": "https://ru.wikipedia.org/api/rest_v1/page/html/\u041e\u0431\u0441\u0443\u0436\u0434\u0435\u043d\u0438\u0435:\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c_\u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430_\u2014_\u0424\u043e\u0440\u0434\u0430"}, "extract": "\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430\u00a0\u2014 \u0424\u043e\u0440\u0434\u0430\u00a0\u2014 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u043f\u043e\u0438\u0441\u043a\u0430 \u043a\u0440\u0430\u0442\u0447\u0430\u0439\u0448\u0435\u0433\u043e \u043f\u0443\u0442\u0438 \u0432\u043e \u0432\u0437\u0432\u0435\u0448\u0435\u043d\u043d\u043e\u043c \u0433\u0440\u0430\u0444\u0435. \u0417\u0430 \u0432\u0440\u0435\u043c\u044f O(|V| \u00d7 |E|) \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u043d\u0430\u0445\u043e\u0434\u0438\u0442 \u043a\u0440\u0430\u0442\u0447\u0430\u0439\u0448\u0438\u0435 \u043f\u0443\u0442\u0438 \u043e\u0442 \u043e\u0434\u043d\u043e\u0439 \u0432\u0435\u0440\u0448\u0438\u043d\u044b \u0433\u0440\u0430\u0444\u0430 \u0434\u043e \u0432\u0441\u0435\u0445 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445. \u0412 \u043e\u0442\u043b\u0438\u0447\u0438\u0435 \u043e\u0442 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0430 \u0414\u0435\u0439\u043a\u0441\u0442\u0440\u044b, \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430\u00a0\u2014 \u0424\u043e\u0440\u0434\u0430 \u0434\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u0440\u0451\u0431\u0440\u0430 \u0441 \u043e\u0442\u0440\u0438\u0446\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u0432\u0435\u0441\u043e\u043c. \u041f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e \u0420\u0438\u0447\u0430\u0440\u0434\u043e\u043c \u0411\u0435\u043b\u043b\u043c\u0430\u043d\u043e\u043c \u0438 \u041b\u0435\u0441\u0442\u0435\u0440\u043e\u043c \u0424\u043e\u0440\u0434\u043e\u043c.", "extract_html": "<p><b>\u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430\u00a0\u2014 \u0424\u043e\u0440\u0434\u0430</b>\u00a0\u2014 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u043f\u043e\u0438\u0441\u043a\u0430 \u043a\u0440\u0430\u0442\u0447\u0430\u0439\u0448\u0435\u0433\u043e \u043f\u0443\u0442\u0438 \u0432\u043e \u0432\u0437\u0432\u0435\u0448\u0435\u043d\u043d\u043e\u043c \u0433\u0440\u0430\u0444\u0435. \u0417\u0430 \u0432\u0440\u0435\u043c\u044f <i>O(|V| \u00d7 |E|)</i> \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u043d\u0430\u0445\u043e\u0434\u0438\u0442 \u043a\u0440\u0430\u0442\u0447\u0430\u0439\u0448\u0438\u0435 \u043f\u0443\u0442\u0438 \u043e\u0442 \u043e\u0434\u043d\u043e\u0439 \u0432\u0435\u0440\u0448\u0438\u043d\u044b \u0433\u0440\u0430\u0444\u0430 \u0434\u043e \u0432\u0441\u0435\u0445 \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0445. \u0412 \u043e\u0442\u043b\u0438\u0447\u0438\u0435 \u043e\u0442 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0430 \u0414\u0435\u0439\u043a\u0441\u0442\u0440\u044b, \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u0411\u0435\u043b\u043b\u043c\u0430\u043d\u0430\u00a0\u2014 \u0424\u043e\u0440\u0434\u0430 \u0434\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u0442 \u0440\u0451\u0431\u0440\u0430 \u0441 \u043e\u0442\u0440\u0438\u0446\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u0432\u0435\u0441\u043e\u043c. \u041f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e \u0420\u0438\u0447\u0430\u0440\u0434\u043e\u043c \u0411\u0435\u043b\u043b\u043c\u0430\u043d\u043e\u043c \u0438 \u041b\u0435\u0441\u0442\u0435\u0440\u043e\u043c \u0424\u043e\u0440\u0434\u043e\u043c.</p>", "wiki_url": "https://ru.wikipedia.org/wiki/%D0%90%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC_%D0%91%D0%B5%D0%BB%D0%BB%D0%BC%D0%B0%D0%BD%D0%B0_%E2%80%94_%D0%A4%D0%BE%D1%80%D0%B4%D0%B0"}}};
</script>

      
      <div class="navigation">
          <a href="lec_1_10.html">← взад</a>
          <a href="index.html">на главную</a>
          <a href="lec_1_12.html">вперёд →</a>
      </div>
      

      
  </article>
<script src="https://demiurg906.github.io/au-algorithms-sem_1/assets/popup.js"></script>
</body>
</html>